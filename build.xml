
<project name="jLEMS" default="jar" basedir=".">

    <description>LEMS Interpreter</description>
	  
    <property file="VERSION"/>
  

	
    <path id="testlib.classpath">
        <pathelement location="lib/junit-4.8.1.jar"/>
    </path>
	
    <path id="testrun.classpath">
        <pathelement location="lib/junit-4.8.1.jar"/>
        <pathelement location="build"/>
    </path>
	 
	
    <target name="initdirs">
        <mkdir dir="build"/>
    	<mkdir dir="builtjars"/>
    </target>



    <target name="compile" depends="initdirs"
            description="Compiles the source code">

        <echo>Compiling to dir: build</echo>
        
        <javac srcdir="src"
               destdir="build"
               debug="true"
               optimize="${optimize}"
               compiler="modern"
               source="1.5"
               target="1.5"
               includeantruntime="false">
            <include name="**/*.java"/>
        </javac>
        	
        <copy todir="build">
            <fileset dir="build" includes="examples/*.xml"/>
        </copy>
    </target>


    <target name="compiletests" depends="compile"
          description="Compiles the test code">

        <javac srcdir="test"
               destdir="build"
               debug="true"
               optimize="${optimize}"
               compiler="modern"
               source="1.5"
               target="1.5"
               includeantruntime="false"
      		   classpathref="testlib.classpath">
            <include name="**/*.java"/>
        </javac>
    </target>



    <target name="jar" depends="compile" description="Creates main Jar file">
		
        <jar destfile="builtjars/lems-${version.number}.jar">
            <fileset dir="build"/>
            <fileset dir="src"/>
            <manifest>
                <attribute name="Main-Class" value="org.lemsml.Main"/>
            </manifest>
        </jar>
    	<copy tofile="builtjars/lems.jar" file="builtjars/lems-${version.number}.jar"/>
    </target>
   
	
    
	  
 
 
 
 
    <target name="clean" description="Removes the built files" depends="initdirs">
        <delete dir="build"/>
    	<mkdir dir="build"/>
      
    </target>

   
     

</project>
